<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chart Data</title>
</head>
<body>
<table>
    <thead>
    <tr>
        <th>idx</th>
        <th>opening_price</th>
        <th>high_price</th>
        <th>low_price</th>
        <th>trade_price</th>
        <th>candle_acc_trade_volume</th>
        <th>candle_date_time_kst</th>
    </tr>
    </thead>
    <tbody id="chart-data">
    </tbody>
</table>

<script src="/webjars/sockjs-client/1.3.0/dist/sockjs.min.js"></script>
<script src="/webjars/stomp-websocket/2.3.3/dist/stomp.min.js"></script>
<script>
    const socket = new SockJS('/chartdata-websocket');
    const stompClient = Stomp.over(socket);
    stompClient.connect({}, function(frame) {
        console.log('Connected: ' + frame);
        stompClient.subscribe('/topic/chartdata', function(chartData) {
            const data = JSON.parse(chartData.body);
            const row = "<tr>" +
                "<td>" + data.idx + "</td>" +
                "<td>" + data.opening_price + "</td>" +
                "<td>" + data.high_price + "</td>" +
                "<td>" + data.low_price + "</td>" +
                "<td>" + data.trade_price + "</td>" +
                "<td>" + data.candle_acc_trade_volume + "</td>" +
                "<td>" + data.candle_date_time_kst + "</td>" +
                "</tr>";
            document.getElementById("chart-data").innerHTML += row;
        });
    });
</script>
</body>
</html>